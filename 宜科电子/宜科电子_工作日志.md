## 问题与解决方案

### - 创建新的.Net FrameWork项目遇到了一些问题

```txt
今天想尝试创建新的 后台项目，我也拿不准用.NET FrameWork 还是 .Net Core,看之前我做的都是 .NET FrameWork 。于是我新建了一个.Net FrameWok项目，但是当我想改变虚拟目录 的运行端口时，报了一个 无法访问此网站 的错误。网上搜索，改配置文件或是VS设置 都解决不了。于是 copy 了 22ChongQingMES 项目 的 后端代码。复制粘贴后。修改了 文件夹/解决方案/目录的名称，然后使用idea 查找修改前的目录名，进行全局修改，然后重新用VS打开项目 =》 项目端口可以修改 且 查询端口 也可以访问到，问题解决。
ps: 解决方案文件可以用 notepad++或 记事本打开，里面也有启动的路径，是需要修改的。但还是建议 修改全局。这样一劳永逸

未来一段时间应该会用这种方式来 新建 .Net FrameWork 项目了
```

### - 窗口伸缩适配

来源：长春一汽二次涂装项目——能源信息——计划录入

### 说明

```txt
这部分是下面的html代码：
			<div id="p" class="easyui-panel" data-options="fit:true" style="border: 0px">
            	<div id="container">
                	<div class="box">
                
使用 #container + .box 包裹盒子 实现伸缩布局
#p 用于触发事件
```

### css

```css
#container {
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    overflow: hidden;
}

.box {
    overflow: hidden;
    position: relative;
    width: 1332px;
    height: 673px;
}
```

### html

```html
<div id="pagetitle" class="easyui-panel" title="计划录入" data-options="fit:true" style="padding: 5px;">
        <div id="p" class="easyui-panel" data-options="fit:true" style="border: 0px">
            <div id="container">
                <div class="box">
                    <div class="easyui-layout" data-options="fit:true">
                        <div data-options="region:'north',border:false">
                            <div class="search_condition">
                                <label>年份：</label>
                                <input id="year" />
                            </div>
                            <div class="search_condition">
                                <a href="#" id="btnYearPlanQuery" class="easyui-linkbutton functionbutton" iconcls="icon-search">查询</a>
                                <a href="#" id="btnYearPlanRefresh" class="easyui-linkbutton functionbutton" iconcls="icon-reload">刷新</a>
                                <a href="#" id="btnYearPlanNew" class="easyui-linkbutton functionbutton" iconcls="icon-add">新增</a>
                                <a href="#" id="btnYearPlanEdit" class="easyui-linkbutton functionbutton" iconcls="icon-edit">编辑</a>
                                <a href="#" id="btnYearPlanDelete" class="easyui-linkbutton functionbutton" iconcls="icon-remove">删除</a>
                            </div>
                        </div>
                        <div data-options="region:'west',border:false" style="width: 48%;">
                            <table id="dg_yearplan" title="年度计划录入" style="width: 100%; height: 100%"
                                rownumbers="true" striped="true" singleselect="true" pagination="false"
                                data-options="url:'<%=ResolveUrl("~/WebHttpHandlers/ShiftInfo/ShiftManagementHandler.ashx?method=Query") %>'">
                                <thead>
                                    <tr>
                                        <th field="shiftname" width="80px" align="center" halign="center">年份</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">单车消耗</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">电能费用</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">水费用</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">天然气费用</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">高温水费用</th>
                                        <th field="shiftname" width="80px" align="center" halign="center">采暖水费用</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div data-options="region:'east',border:false" style="width: 52%; padding-left: 4px">
                            <div style="height: 100%;">
                                <div class="easyui-panel" title="分区计划录入" data-options="fit:true,border:true">
                                    <div class="easyui-layout" data-options="fit:true">
                                        <div data-options="region:'north',border:false" style="padding: 5px;">
                                            <div class="search_condition">
                                                <label>月份：</label>
                                                <select id="parm_month" class="easyui-combobox" style="width: 120px;"
                                                    data-options="panelHeight: 'auto', panelMaxHeight: 400,editable:false,valueField: 'label',textField: 'value',
                                                   iconWidth:22, icons:[{iconCls:'icon-clear',handler:function(e){ $(e.data.target).combobox('clear');}}]">
                                                    <option value="" selected="selected">所有</option>
                                                    <option value="1">一月</option>
                                                    <option value="2">二月</option>
                                                    <option value="3">三月</option>
                                                    <option value="4">四月</option>
                                                    <option value="5">五月</option>
                                                    <option value="6">六月</option>
                                                    <option value="7">七月</option>
                                                    <option value="8">八月</option>
                                                    <option value="9">九月</option>
                                                    <option value="10">十月</option>
                                                    <option value="11">十一月</option>
                                                    <option value="12">十二月</option>
                                                </select>
                                            </div>
                                            <div class="search_condition">
                                                <label>区域：</label>
                                                <input id="parm_area" class="easyui-combobox textinput" style="width: 120px;"
                                                    data-options="panelHeight: 'auto', panelMaxHeight: 400,valueField: 'code',textField: 'text',editable:false,
                                      url:'<%=ResolveUrl("~/WebHttpHandlers/BaseInfo/BaseInfoHandler.ashx?method=EnergyAreaList") %>',
                                      iconWidth:22, icons:[{iconCls:'icon-clear',handler:function(e){ $(e.data.target).combobox('clear');}}]" />
                                            </div>
                                            <div class="search_condition">
                                                <a href="#" id="btnQuery" class="easyui-linkbutton functionbutton" iconcls="icon-search">查询</a>
                                                <a href="#" id="btnRefresh" class="easyui-linkbutton functionbutton" iconcls="icon-reload">刷新</a>
                                                <a href="#" id="btnNew" class="easyui-linkbutton functionbutton" iconcls="icon-add">新增</a>
                                                <a href="#" id="btnEdit" class="easyui-linkbutton functionbutton" iconcls="icon-edit">编辑</a>
                                                <a href="#" id="btnDelete" class="easyui-linkbutton functionbutton" iconcls="icon-remove">删除</a>
                                            </div>
                                        </div>
                                        <div data-options="region:'center'" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px">
                                            <table id="dg_areaplan" class="easyui-datagrid" style="width: 100%; height: 100%"
                                                striped="true" singleselect="true" rownumbers="true" data-options="border:0,
                                               url:'<%=ResolveUrl("~/WebHttpHandlers/ShiftInfo/ShiftManagementHandler.ashx?method=TimeQuery") %>'">
                                                <thead>
                                                    <tr>
                                                        <th field="eventname" width="120px" align="center" halign="center">分区</th>
                                                        <th field="begintime" width="120px" align="center" halign="center">月份</th>
                                                        <th field="endtime" width="120px" align="center" halign="center">电能用量</th>
                                                        <th field="breakbegintime" width="120px" align="center" halign="center">水量</th>
                                                        <th field="breakendtime" width="120px" align="center" halign="center">天然气用量</th>
                                                    </tr>
                                                </thead>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
```

### js

```js
 	$(function () {
        $("#p").panel({
            onResize: function () {
                onwindowresize();
            }
        });
    });

	//保存DIV大小
    save_h1 = 0;
    save_w1 = 0;
    //窗体大小变化时调整缩放比例
    function divresize() {
        //return;
        h = $(".box").height().toFixed(4);
        w = $(".box").width().toFixed(4);
        h1 = $("#container").height().toFixed(4);
        w1 = $("#container").width().toFixed(4);
        if (w1 != save_w1 || h1 != save_h1) {
            //div大小有变动，保持当前大小并变换显示比例
            save_w1 = w1;
            save_h1 = h1;
            var ratioy = h1 / h;
            var ratiox = w1 / w;
            $('.box').css({
                'transform': 'scale(' + ratiox + ', ' + ratioy + ')',
                'transform-origin': '0 0',
            });
        }
    };

    var timer1 = 0;   //计时器
    function onwindowresize() {
        clearTimeout(timer1);
        timer1 = setTimeout(divresize, 100);
    };
    window.onload = onwindowresize;
    window.onresize = onwindowresize;
```

## 2022年

简介：2022年3月14日 在宜科电子入职

### 3月

#### 第一周

##### 2022年3月14日 周一

```txt
1.搭建环境【sqlserver2016、VS2019、notepad++、typora、idea、有道、clash、百度云盘、谷歌浏览器、迅雷、snipaste截图软件、office2016专业版】
```

##### 2022年3月15日 周二

```txt
1.搭建完毕开发环境
2.创建svn用户，安装配置本地ToriseSVN环境
3.熟悉 佛山-一汽大众-中控程序 项目
```

##### 2022年3月16日 周三

```txt
1.学习github上的mes系统前端项目
2.熟悉佛山 一汽大众 中控程序 的前端，和 前端C#的交互方式
```

##### 2022年3月18日 周四

```txt
1. 从前端到后端整个流程中，查找自己不会/不熟悉的技术点
2. 学习ado.net 连接数据库的方式
3. 熟悉 sql 的 某些关键字，重点熟悉了 left join/right join/inner join
```

##### 2022年3月18日 周五

```txt
1. 熟悉 sqlserver 的存储过程
2. 移植之前熟悉的技术点
3. 扩充静态资源
```

#### 第二周

##### 2022年3月21日 周一

```txt
1. 和章工学习佛山 一汽大众 中控系统的 项目
2. 看菜单项实现，看授权的实现
```

##### 2022年3月22日 周二

```txt
1. 与章工确认数据结构，并完成标题和数据的json制作
2. 在数据库加入对应页面，在页面做显示
3. 在页面用假数据（商量好的数据结构），完成数据在 日产量报表的 展示
```

##### 2022年3月23日周三

```txt
1. 完善前端部分，将修改数据，进行前台的数据显示测试
2. 将查询条件+按钮，在前端实现（借鉴DailyYieldQuery页面）。
3. 修改页面名称
```

##### 2022年3月24日 周四

```txt
1. 调试后台接口，并在前台对表格内的数据做处理
2. 处理后台的JSON格式，经常因为有字段没有引号，而无法解析！！！
3. 在前台处理后台传输的数据，做好用户的使用交互
```

##### 2022年3月25日 周五

```txt
1. 完成前台合并行，添加导出Excel按钮
2. 正在开发 定制化导出 Excel 的功能
```



#### 第三周

##### 2022年3月28日 周一

```txt
1. 根据 汇总表 的Excel文件，查找到对应的 后台 样板程序
2. 和吕工沟通，根据用户的需求，更改汇总表的前台展示部分
```

##### 2022年3月29日 周二

```txt
1. 开发 汇总表的 Excel导出功能 的后台部分。定制 页面导出的 样式
2. 和吕工沟通，根据用户的需求，更改汇总表的前台和导出表格的样式
```

##### 2022年3月30日 周三

```txt
1. 完成 汇总表的 前台 和 后台业务功能 测试。
2. 完成汇总表第一版 的 提交 
```

##### 2022年3月31日 周四

```txt
1. 修改 能源分析页面 的前台部分。
2. 和吴工沟通 能源分析页面的 数据展示实现
```

##### 2022年4月1日 周五

```txt
1. 依据用户的需求，更改能源分析页面的 Excel导出功能
2. 修改 能源分析页面 的存储过程。
3. 提交 能源分析页面的 修改。备份相关存储过程
```

##### 2022年4月2日周六

```txt
1. 参与项目梳理工作，用腾讯会议的方式，学习页面实现与业务逻辑
2. 新增 网络调用失败 弹窗的 定时关闭
3. 正在修改 日产量汇总表的 导出Excel 功能错误
```



### 4月

#### 第一周

##### 2022年4月6日 周三

```txt
学习存储过程相关代码，包括实现方式，语法结构等
```

##### 2022年4月7日周四

```txt
开始实践谷粒商城项目
```

##### 2022年4月8日周五

```txt
1.实践谷粒商城项目，搭建基本环境【编译器，jdk，中间件，虚拟机】
2.修改 日产量汇总表 的功能 —— 导出Excel中 静态表头改为动态表头
3.新增需求：不同时间模型，查询表格数不同。 在 日产量汇总表 页面 可能展示 一张/二张/三张 表，并导出
```

#### 第二周

##### 2022年4月11日周一

```txt
1. 根据需求开发 日产量汇总表，让章工看一下效果，继续后续的开发
2. 修改日产量汇总表的前端实现【将table变成动态实现】
3. 备份 佛山中控的 测试库，在 本地 使用 4-8的版本
```

##### 2022年4月12日周二

```txt
开发 日产量汇总表 的后台 Excel导出功能【表头部分还未修改，表内数据正在开发调试很快完成】
```

##### 2022年4月13日周三

```txt
1. 开发完成 日产量汇总表 的 需求修改
2. 测试 日产量汇总表 更改后的功能
3. 日产量汇总表 代码 提交到svn
```

##### 2022年4月14日周四

```txt
1. 学习 与OPC交互的方式，包括 软件交互(C#)和硬件交互(KepServer/OPC Client)
2. 通过调用 模拟设备数据，实现跑马灯程序
```

##### 2022年4月15日周五

```txt
1. 学习Sql的实用技巧
2. 完成 OPC 模拟设备 的 订阅与读取操作，完成跑马灯案例
3. 练习谷粒商城项目
```

#### 第三周

##### 2022年4月18日周一

```txt
前提：章工发现服务器中了勒索病毒，并查询解决方案
1. 安装360杀毒，腾讯管家杀毒，进行全局杀毒。并把所有的移动设备，包括U盘/移动硬盘，扫描一遍
2. 学习谷粒商城项目
```

##### 2022年4月19日周二

```txt
练习谷粒商城项目，学习linux的使用，项目架构的搭建
```

##### 2022年4月20日周三

```txt
学习谷粒商城项目的 renrenfast接口自动生成【列表数据的增删改查】
```

##### 2022年4月21日周四

```txt
1. 参与 魏工 组织的 Mui+ html5 APi 的移动端 培训
2. 运行MUI 的 demo 项目【mui在页面上的实现示例】
3. 运行html5 API 的 demo 项目【包括 操作 安卓设备的camera实例，读取 安卓设备参数实例等】
4. 运行 赛达平台升级工业互联网项目。【李工帮助 配置了Windows的IIS服务并设置好了C#程序的端口号和程序名称，将打包好的C#后台程序AppAPI部署到安卓设备】【通过 魏工给的pad 在HbuilderX编辑器环境下，把前台界面展示到了 安卓设备上】
```

##### 2022年4月22日周五

```txt
1. 学习 MUI 的 demo 项目
1. 学习 html5 API 的 demo 项目
1. 学习 赛达平台升级工业互联网项目
```

#### 第四周

##### 2022年4月24日周日

```txt
熟悉 C#后台程序的启动，在没有前台的支持下，需要 协议:IP:端口号/处理文件路径/?参数对象  来访问对应的接口地址，获取数据
如： localhost:9001/AppAPI/xxxHandler.ashx/?mehotd= Query
```

##### 2022年4月25日周一

```txt
尝试移植代码，把 赛达平台那个 复杂项目做优化 到 章工 给的 实例上
```

##### 2022年4月26日周二

```txt
1. 解决IIS服务器无法连接的问题
【windows添加/删除功能 =》 启用windows服务 找 internet information service 的服务】
【Windows Defender 防火墙 =》高级设置 =》入站规则 =》配置 8001端口】
完成以上两项，问题解决
```

##### 2022年4月27日周三

```txt
1.解决 显示预配表头 的问题，原因是IIS服务只允许在内网环境下 使用，手机热点/蓝牙热点 都不能用
2.开发 AppWMS 实例
```

##### 2022年4月28日周四

```txt
1.熟悉AppAPI后台
2.学习谷粒商城
```

##### 2022年4月29日周五

```txt
1.继续周四的工作
2.AppWMS 的菜单选择按钮/菜单项 动态化，
```



### 5月

#### 第一周

##### 2022年5月5日 周四

```txt
1.AppWMS 的左侧列表动态化，重构 index 页面
2.新增 主页跳转  左右立库 功能
```

##### 2022年5月6日 周五

```txt
实现在页面 摆放60个菜单项。备份当前项目，再根据需求继续开发 
```

##### 2022年5月7日 周六

```txt
1.开会确定 重庆演示项目 的整体需求【数据库表的确定，数据关系的确定(vga,订单，仓储，立库等等)】
2.开发前台的 立库页面 的 静态实现
```

#### 第二周

##### 2022年5月9日 周一

```txt
1. 移植 订单页面 到 重庆演示项目中
2. 开发 订单+加工装配 页面
3. 开发 静态页完成后，确认静态页展现的效果， 再进行 后台接口的 数据交互格式 和 前后台交互
4. 解决 mi-pad 无法连接 IIS 服务的问题。
  (pad+XBuilder) => 组成客户端 【pad与XBuilder用USB相连】
  (IIS) => 服务端【(IIS 服务需要在 同一局域网下 才能使用，所以pad也需要 和 电脑 在同一网络下)】 
```

##### 2022年5月10日周二

```txt
1. 开发 换线装配 界面。无论移植layer插件 还是 原版页面 都会有所卡顿
2. 使用原生 开发 左侧 table。在原生开发后，页面的响应速度有了很大的提升
PS：工业移动端，最好都用原生开发，用了很多的插件，都会有卡顿
```

##### 2022年5月11日周三

```txt
1. 开发 AppWMS 项目
2. 学习 websocket 的 创建方法中的 protocal参数的使用
```

##### 2022年5月12日周四

```txt
1. 确认 重庆工职院MES 项目 的 数据库表
2. 开发 重庆工职院MES 仓储页面 的 存储过程 
```

##### 2022年5月13日周五

```txt
1.确认 重庆互联网 项目 的 仓储 基础 订单表
2.熟悉并开发 重庆互联网 项目 的 存储过程。
```



##### 第三周

###### 2022年5月16日周一

```txt
请假
```

###### 2022年5月17日周二

```txt
1.开发 立库 页 —— 存储过程的 查询立库页、websocket更新、物料转换 等过程
2.开发 订单 页 —— 存储过程的 查询左侧列表 过程
```

###### 2022年5月18日周三

```txt
开发 订单页 —— 存储过程 的 查询右侧列表、websocket更新、按钮状态、上移、下移、停止/关闭 的 过程
```

###### 2022年5月19日周四

```txt
(汇报时-不重要)1. 开会 解决 sch_running 数据表 和 更新websocket 的数据问题。
(汇报时-不重要)2. 开会培训 AppAPI的搭建，websocket后台书写；KEPserver 使用
3. 依据AppAPI(18赛达平台升级工业互联网项目 GRJ2103)移植并搭建 重庆工职院MES 项目 的后端 AppWMSAPI
```

###### 2022年5月20日周五

```txt
1. 根据 主页的 UI 开发 主页 的 页面 和 交互
2. 开发 立库页面(机加工库,环线库) 的 的 后端API ，包括 托盘查询接口、托盘修改接口、websocket更新接口
```



##### 第四周

###### 2022年5月23日周一

```txt
1.开发 机加工库页面 的 前端页面
2.联调 机加工库页面 的 前后台
```

###### 2022年5月24日周二

```txt
1.开发 环线库页面 的 前端页面
2.联调 环线库页面 的 前后台

目前进度：还剩 订单页面 的 OpenWebSocket、MoveUp、MoveDown、RunState
```

###### 2022年5月25日周三

```txt
开发 环线订单页 和 CNC加工订单页 后端 API。  包括：订单查询、订单更新、执行状态查询、执行状态修改、订单上下移

目前进度：还剩 订单页面 的 MoveUp、MoveDown、RunState
```

###### 2022年5月26日周四

```txt
1.开发 环线订单页 和 CNC加工订单页 后端 API
2.开发 环线订单页 和 CNC加工订单页 页面 + JS
3.修改 立库和订单页 的样式
4.优化 修改按钮状态的 存储过程
```

###### 2022年5月27日周五

```txt
1.开发 环线订单页 和 CNC加工订单页 页面 + JS
2.联调 环线订单页 和 CNC加工订单页 的前后端功能
```

###### 周报

```txt
1. 开发 机加工库 与 环线库 的 前端JS 和 后端C#接口(例：库位更新接口，全部库位信息 查询,按钮状态查询修改等）
2. 开发 环线订单 和 CNC加工订单 的 前端JS 和 后端C#接口(例：订单查询、订单更新、执行状态查询、执行状态修改、订单上下移等)
3. 修改 立库页 和 订单页 的 样式，将 图片 全部改为 矢量图SVG
4. 优化 修改按钮状态 的存储过程
5. 优化 前端代码，通过 JS 初始化 页面的 HTML
```



##### 第五周

###### 2022年5月30日周一

```txt
休假 和 周日 换调休
```

###### 2022年5月31日周二

```txt
腾讯会议学习佛山中控项目
```

###### 2022年6月1日周三

```txt
腾讯会议学习佛山中控项目
```

###### 2022年6月2日周四

```txt
1.优化 重庆工职院的 前端部分
2.练习 佛山中控项目
```

###### 周报

```txt
1. 优化 重庆工职院 的 前端部分，包括 立库页面 和 订单页面 的静态样式整合 和 js整合
2. 学习 并 熟悉 ai 文件的 绘制方式
3. 熟悉 佛山中控项目 中 使用Echarts实现的功能代码
4. 熟悉 佛山中控项目 的 页面授权的功能代码
```



### 6月



#### 第二周

##### 2022年6月6日周一

```txt
1.备份测试数据库，本地数据库，重庆工职院 的 前台项目
2.整合重庆工职院的 后台数据库，对前台项目 做 前后端的联调
```

##### 2022年6月7日周二

```txt
1.解决Hbuilder无有效证书，项目中有中文路径或文件的问题
2.使用Hbuilder完成App的打包
```

##### 2022年6月8日周三

```txt
与重庆工职院 项目 现场人员沟通 项目联调事宜
```

##### 2022年6月9日周四

```txt
1.接手 N117_Andon 项目 的 web重构 【重构项目叫AndonScreen】
2.搭建 AndonScreen 项目 的 web目录结构【新项目叫 AndonScreen】
3.开发 AndonScreen 项目 的 静态页
```

##### 2022年6月10日周五

```txt
1.开发 AndonScreen 项目 的 静态页
2.熟悉并绘制 AndonScreen 工位部分的 svg
```

##### 2022年6月11日周六

```txt
1.绘制 AndonScreen 工位部分的 svg
```

##### 周报

```txt
1.整合重庆工职院项目 的 前后台数据库，并做备份
2.在测试环境 调试 前台项目，保证数据的准确和页面的稳定
3.解决Hbuilder 的证书问题，将 重庆工职院的 前台项目打包成apk
4.与 重庆工职院 现场人员 沟通 联调时间，完成前台页面的 生产环境调试
5.接手N117_Andon项目的重构，搭建AndonScreen项目
6.开发AndonScreen的静态页
7.绘制AndonScreen 工位区域 的 人工上下件 svg
```



#### 第三周

##### 2022年6月13日周一

```txt
绘制AndonScreen中svg的 滚边岛/地板岛/焊接岛/人工上下件 
```

##### 2022年6月14日周二

```txt
1.绘制AndonScreen中svg的剩余部分
2.备份并导出 AndonScreen工位的svg和ai
```

##### 2022年6月15日周三

```txt
1.AndonScreen 页面引入 SVG代码，调整样式表的代码，实现屏幕自适应
2.开发完成 查询接口，完成前后台的调试与测试
```

##### 2022年6月16日周四

```txt
1.重建 N117Andon 数据库。
2.熟悉CEF(Chromium嵌入式框架)。
3.在公告栏加入iframe标签，完成iframe的高度自适应
```

##### 2022年6月17日周五

```txt
1.向 N117Andon 数据库 插入 模拟数据
2.将静态页导入CEF框架，重建AndonScreen项目
3.修改 前台的回显逻辑，完成 页面左侧 的查询功能
```

##### 周报

```txt
1. 绘制AndonScreen项目所需svg
2. 导入svg代码，调试页面样式，实现自适应
3. 完成 查询接口 和 前后台联调
4. 重建N117Andon数据库
5. 熟悉CEF(Chromium嵌入式框架)
6.在公告栏加入iframe标签，实现iframe的高度自适应
7.插入模拟数据，使用CEF框架获取数据。修改 页面回显逻辑，完成查询功能的联调
```



#### 第四周

##### 2022年6月20日周一

```txt
1.按照 N11Andon的 CAD图 确定 SVG上 各个电器件的 ID
2.修改AndonScreen的 svg
```

##### 2022年6月21日周二

```txt
1.按照N117Andon现场 设备图，修改AndonScreen 的 svg 
2.调整前端页面布局
```

##### 2022年6月22日周三

```txt
请假
```

##### 2022年6月23日周四

```txt
需做任务：1.修改id，给 灯 添加 自定义属性
		2.修改VIN和INFO的id，用标准命名
		3.用户页面是 在 D 盘下 Notice 文件夹 中 的notice.html （位置固定的html）
		4.iframe 的src 后面加个时戳：src="https://www.sina.com.cn?a=111111"
		
完成：
1.修改 svg 的 id，保证ST和ST1查找的元素的准确性
2.修改iframe标签的属性，隐藏滚动条
		
```

##### 2022年6月24日周五

```txt
1.在数据库加入测试数据
2.完成前台展现逻辑
3.测试展现逻辑，修改逻辑
```

##### 周报

```txt
1.根据 N117Andon 的 CAD图 修改 SVG的器件ID
2.修改 AndonScreen 的 前端 样式
3.完成 AndonScreen 的 iframe 页面刷新
4.解决iframe 的显示bug
5.录入测试数据，测试AndonScreen项目的业务功能，调试修改前后端代码
```



#### 第五周

##### 2022年6月27日周一

```txt
1. 解决 AndonScreen 页面 修改灯状态后 不重新渲染的问题
2. 完成 告警统计 部分 的前后端交互，并初步测试
```

##### 2022年6月28日周二

```txt
1.重新注册 Hbuilder 账号
2.使用传统方式 给 重庆工职院项目 进行打包测试
```

##### 2022年6月29日周三

```txt
请假一天
```

##### 2022年6月30日周四

```txt
修改 重庆工职院Mes项目的 静态页部分
```

##### 2022年7月1日周五

```txt
修改 存储过程中的 订单 相关字段，重做 后端的 业务逻辑
```



##### 周报

```txt
1. 解决 AndonScreen 页面 修改灯状态后 不重新渲染的问题
2. 完成 告警统计 部分 的前后端交互，并初步测试
3. 重新注册 Hbuilder 账号
4. 使用传统方式 给 重庆工职院项目 进行打包测试5
5. 修改 重庆工职院Mes项目的 静态页部分
6. 修改 存储过程中的 订单页 相关字段，修改 后端的 业务代码
```



### 7月

#### 第一周

##### 2022年7月4日周一

```txt
1.优化 AndonScreen 的前台代码
2.配合重庆现场 做前台项目 调试
```

##### 2022年7月5日周二

```txt
1.新增并修改AndonScreen 的svg内容
2.修改svg部分的h5+css
```

##### 2022年7月6日周三

```txt
1.学习佛山中控项目的default页面的自适应写法
2.使用生产环境参数 打包 重庆工职院 前台项目 apk
```

##### 2022年7月7日周四

```txt
1.配合重庆现场联调前台项目
2.修改 AndonScreen项目 的 web部分
3.配合佛山现场 开发仪表盘 组件
```

##### 2022年7月8日周五

```txt
配合佛山现场 开发仪表盘 组件
```

##### 周报

```txt
1.根据 重庆现场 的 pad分辨率 修改前台样式表
2.使用生产环境参数 打包 apk。与重庆现场的李工联络，完成pad的安装调试。
3.优化 AndonScreen 的前台代码
4.按需求 修改重做 AndonScreen 的 SVG，并更新index.html
5.配合佛山现场 开发仪表盘 组件
```

#### 第二周

##### 2022年7月11日周一

```txt
1.配合重庆现场 调试 前台项目
2.学习KepServer的实例项目
3.封装仪表盘控件
```

##### 2022年7月12日周二

```txt
1.确认Andon项目的客户需求和修改方案
2.重做SVG内部元素的比例
```

##### 2022年7月13日周三

```txt
1.根据CAD图修改SVG的 样式，布局，重做svg中各个元素的位置和尺寸
2.根据 AGV数据OPC导入 文件 在 svg 中 各区域标出 特定的agv元素
```

##### 2022年7月14日周四

```txt
1.根据CAD图修改SVG的 样式，布局
2.根据 Excel 与 Sqlserver 确认器件 的 ID ，并修改 SVG
3.与重庆现场做联调，使用新的ip更新apk信息
```

##### 2022年7月15日周五

```txt
1.根据Excel在SVG中标注好对应的设备和告警编码Id
2.调整SVG
3.学习AndonScreen 项目 的后台数据实现

PS：Andon项目后台数据实现 详细流程： 
      - 数据后台是由 宜科电子提供一个服务  连接KepServer和SqlserverDB
      - 宜科电子服务会更新 数据到DB，同时更新RealTimeSignal、Records、Tag 三张表
      - 实时信号表RealTimeSignal 会将数据同步到 告警记录表Records 和 大屏数据表Tag 中
      - 最终 大屏 得到 了数据更新的提示，通过CEF框架更新数据
```

##### 周报

```txt
1.配合重庆现场联调 前台项目，根据生产环境参数，更新APK包
2.在 AndonSCreen 的SVG中新增 告警信号 和 急停安全信号
3.根据客户的需求，针对性修改 svg 的样式和布局
4.由于重庆现场库位变化，重新调整 立库页面的 元素位置和布局
```



#### 第三周

##### 2022年7月18日周一

```txt
1.修改AndonScreen项目的前端页面(1.改左侧栏宽度缩写，2.告警分析图块高度缩写小，3.告警内容块高度扩大，改成marquee从下到上滚动，此处需改js，4.替换中间栏的SVG)
```

##### 2022年7月19日周二

```txt
1.调整SVG样式
2.修改告警统计的前端实现 + 样式
3.使用marquee实现设备告警部分的滚动
```

##### 2022年7月20日周三

```txt
1.修改marque 在 生产大屏 的 设备告警 的闪动bug
2.使用VScroll组件调整 设备告警 的功能
```

##### 2022年7月21日周四

```txt
1.完成生产大屏 的 功能测试 和 部署
2.本地导入GRJ2025_HongQiN117Andon的ecos数据库架构
3.进行Sqlserver链接数据库访问mysql的配置操作
```

##### 2022年7月22日周五

```txt
1.完成Sqlserver链接数据库访问mysql的配置
2.学习Sqlserver链接数据库 的 sql写法
```

##### 扩展

```sql
链接服务器的配置：
方案1：
在链接服务器添加的弹窗输入
访问字符串： DRIVER={MySQL ODBC 5.3 Unicode Driver};SERVER=127.0.0.1;DATABASE=ecos;PORT=3306
驱动选 有ODBC的
之后要在安全性中 加入 用户名和密码
方案2：
在 控制面板 - 管理工具 - ODBC数据源(64位) - 系统DSN - 添加(输入名称Name，数据库链接信息等)
在链接服务器中 驱动选 有ODBC的，名称输入 添加的ODBC数据源名称
不需要在安全性中 加入 用户名和密码

127.0.0.1
root
root

//LOCALHOST_DB是 链接服务器的名字
SELECT  es.*  FROM    OPENQUERY(LOCALHOST_DB, 'select * from ecos.station ') as es;

INSERT OPENQUERY (LOCALHOST_DB,'SELECT es.id,es.type,es.id_position FROM ecos.station es') VALUES ('3','ee','555');

UPDATE OPENQUERY (LOCALHOST_DB,'SELECT es.id,es.type,es.id_position FROM ecos.station es where es.id=3') SET type='aa',id_position=745;

DELETE OPENQUERY (LOCALHOST_DB,'SELECT id FROM ecos.station WHERE id = 3');
```

##### 周报

```txt
1.修改AndonScreen项目的前端页面(1.左侧宽度的调整 2.整体宽度调整 3.marque滚动)
2.修改AndonScreen的SVG
3.用VSroll替换marque的实现方式，完成 设备告警部分 的修改
4.完成 生产环境大屏 的 测试 和 部署
5.本地导入GRJ2025_HongQiN117Andon的ecos数据库架构
6.完成Sqlserver链接数据库的配置
```



#### 第四周

##### 2022年7月25日周1

```txt
今日计划：上周五 在数据库加入了 拧紧数据查询 的菜单项，做好了后台的标记和架子。
        今天在根据 老章 给的 Excel 对一下页面的表格项，看看有没有需要加的 td字段
        筛选项有 id 和 时间戳 等(以一汽大众的为准，没有的删掉)
        
1.明确在页面展示的数据字段
2.使用echarts绘制拧紧曲线图的demo
3.明确 拧紧数据 和 拧紧曲线 的关联字段
4.开发 拧紧数据查询 的 存储过程
```

##### 2022年7月26日周2

```txt
1.完成 查询列表 的存储过程 的开发
2.完成 筛选项信息查询 的存储过程 的开发
3.开发 后台接口
```

##### 2022年7月27日周3

```txt
1.完成前台页面 的交互开发
2.通过Sqlserver写的 存储过程，开发后台接口。。
```

##### 2022年7月28日周4

```txt
预期内容：大屏告警部分要整改
1.开发拧紧曲线存储过程
2.开发拧紧查询页面 的 剩余部分
3.中间出了一个bug，无法使用tighten_id查出数据的bug。后面会有详细说明
4.开发完成拧紧曲线部分的前端功能
5.完成拧紧页面的开发和功能测试

PS：在语句没问题的情况下，我用不同的类型查询sql，均为找到问题。最终，在章工的处理下，发现定义的变量不加长度就会出现查不出数据的问题。

```

##### 2022年7月29日周5

```txt
1.协助重庆工职院现场 完成bug修改
2.完成拧紧数据查询页面的 Excel导出功能和测试 
```

#####  解决方案：

 1.给storetype表加一行数据

```sql
USE [ChongQingGZYMESDB]
GO

INSERT INTO [dbo].[wms_storedtype]
           ([id]
           ,[typename])
     VALUES
           (4
           ,'无托盘')
GO
```

2.修改存储过程app_wms_stock_sel

```sql
USE [ChongQingGZYMESDB]
GO
/****** Object:  StoredProcedure [dbo].[app_wms_stock_sel]    Script Date: 2022/7/29 9:12:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		zhj
-- Create date: 2022-5-17
-- Description:	库位屏: 库位信息查询
-- Param:
--			@store_id 立库号
-- =============================================
ALTER PROCEDURE [dbo].[app_wms_stock_sel] @store_id int
    WITH
    EXEC AS CALLER
AS
begin
--  60个 左右侧 立库
   SELECT 
          ws.id,
		  ws.locationid,
		  ws.storedtypeid,
		  ws.productSN,
		  ws.pencupSN,
		  case when ws.[storedtypeid] = 4 THEN '无托盘'
		       when wst.typename = '原料' then bm.name
			   when wst.typename = '产品' then bp.name
		  else wst.typename end as 'stock_name',
		  wst.typename
   FROM wms_stock ws WITH (NOLOCK) 
    left join wms_storedtype wst on wst.id = ws.storedtypeid
	left join bas_material bm on left(ws.materialid,1) = bm.id
	left join bas_product bp on right(ws.productSN,1) = bp.id
   WHERE ws.id = @store_id and ws.locationid NOT IN ('61','62')
   ORDER BY ws.locationid

-- 中间 61,62 进出口
  SELECT 
          ws.id,
		  ws.locationid,
		  ws.storedtypeid,
		  ws.productSN,
		  ws.pencupSN,
		  case when ws.[storedtypeid] = 4 THEN '无托盘'
		       when wst.typename = '原料' then bm.name
			   when wst.typename = '产品' then bp.name
		  else wst.typename end as 'stock_name',
		  wst.typename
   FROM wms_stock ws WITH (NOLOCK) 
    left join wms_storedtype wst on wst.id = ws.storedtypeid
	left join bas_material bm on left(ws.materialid,1) = bm.id
	left join bas_product bp on right(ws.productSN,1) = bp.id
   WHERE ws.id = @store_id and  ws.locationid IN ('61','62')
   ORDER BY ws.locationid
end

```

##### 周报

```txt
1.根据拧紧系统数据库表接口 确认 在 拧紧数据查询页面所展示的 数据 和 数据筛选项
2.完成 拧紧数据查询 页面 的 存储过程开发，包括列表数据，筛选项数据，曲线数据等
3.完成 拧紧数据查询 页面 的前台页面 ，后台接口 的开发 和 功能测试
4.协助 重庆工职院项目，提供远程支持。解决 库位2 产品无法展示的问题
```



### 8月

#### 第一周

##### 2022年8月1日周1

```txt
1.部署拧紧查询页面，完成链接服务器的搭建
2.修改拧紧数据的Echart前端显示
```

##### 2022年8月2日周2

```txt
确定能源数据点，在本地kepserver创建现场对应目标点
```

##### 2022年8月3日周3

```txt
创建能源数据点 所需存储过程，调试plc数据点
```

##### 2022年8月4日周4

```txt
1.解决PLC无法连接的问题
2.使用simulator通道，进行测试，并修改存储过程
```

##### 2022年8月5日周5

```txt
1.完成能源数据 的 后台数据收集
2.完成前台的 页面搭建和存储过程
3.与现场联络，确认PLC状态和联调的具体时间
```

##### 周报

```txt
1.远程现场电脑，部署拧紧数据功能的前台页面，API代码及存储过程
2.修改拧紧数据曲线的前端echarts
3.与现场联络，确认能源点位。
4.在本地创建能源点位，完成存储过程开发。实现数据收集功能
5.与现场联络，确认PLC状态和具体的联调时间
6.完成前台项目页面和API文件的创建。在菜单项 新增 能源数据项
```



#### 第二周

##### 2022年8月8日周1

```txt
1.与红旗现场马工联络，确认两个告警页面的修改需求。
2.红旗现场PLC设备已恢复，远程确认运行情况
3.开发完成能源数据查询页面，API，存储过程
```

##### 2022年8月9日周2

```txt
1.与现场联系解决PLC设备断电的问题，配合完成能源查询界面的成果客户确认
2.完成能源查询页面的部署工作
```

##### 2022年8月10日周3

```txt
解决生产环境车序Excel无法录入的问题
```

##### 2022年8月11日周4

```txt
与现场沟通需求变更
```

##### 2022年8月12日周5

```txt
与现场沟通需求变更
```

##### 周报

```txt
1.与现场沟通，调试现场Kepserver的PLC设备点
2.完成 能源数据查询 的前后台+存储过程的 开发+测试
3.部署能源数据查询页面 的前后台 及 存储过程
4.帮助现场解决 车序管理 无法导入的问题
5.与现场沟通 告警页面，能源页面 客户的相关需求
```



#### 第三周

##### 2022年8月15日周1

```txt
1.与红旗现场马工沟通客户提出的需求意见
2.修改告警统计页面的区域字段展现
```

##### 2022年8月16日周2

```txt
1.将告警改为报警
2.加排序(根据区域+时间 进行排序)
```

##### 2022年8月17日周3

```txt
请假
```

##### 2022年8月18日周4

```txt
1.与红旗现场联络，确认需求，得到需要更改的功能位置
2.熟悉告警查询部分的功能代码及存储过程
```

##### 2022年8月19日周5

```txt
1.筛选项 区域 改为 下拉框
2.给区域字段 加中文(复制告警查询 所有页面)
```

##### 周报

```txt
1.与红旗现场微信沟通，确认用户提出的需求
2.熟悉告警查询部分的存储过程和代码
3.修改告警页面的文本信息
4.修改告警页面中区域的数据展现
5.修改告警记录查询 页面 的 筛选项。
6.部署修改的功能到现场
```



#### 第四周

##### 2022年8月22日周1

```txt
1.报警查询页面 增加屏蔽文本筛选项，完成前后台交互逻辑
2.报警统计页面 区域改为 下拉菜单
3.检查添加功能是否影响到之前的功能
```

##### 2022年8月23日周2

```txt
预计完成： 1.(报警记录)多文本屏蔽 的存储过程开发 3.多文本屏蔽 功能 的部署
经验：
	- 尝试关联表查法 解决 多文本屏蔽，失败
	- 尝试游标查询 方法 解决多文本屏蔽失败
完成：
	1.使用前端过滤，完成多文本屏蔽功能
	2.完成文本屏蔽功能部署
潜在风险：
	数据量太大，会导致卡顿
```

##### 2022年8月24日周3

```txt
1.完成报警统计 的饼状图开发
2.完成报警统计 的部署工作
```

##### 2022年8月25日周4

```txt
1.确认一车一档的 部分需求
2.远程调试，完成共享文件夹的配置
3.熟悉存储过程，确认在线测量数据
```

##### 2022年8月26日周5

```txt
1.开发存储过程，获取在线测量数据
```

##### 周报

```txt
1.完成 红旗L平台 报警页面 需求功能修改，测试，部署
2.完成 红旗L平台 报警统计 的 饼状图开发，测试，部署
3.确认 一车一档部分 需求，及数据对比的需求
4.开发在线测量数据的存储过程。
5.熟悉L平台后台的相关文档，确认需求所提及的 数据字段 出处
```



#### 第五周

##### 2022年8月29日周1

```txt
1.解决存储过程在读取数据时报错的问题【字段增加了两个，所以 字段截取时也要 退后两个。不然会出错。表头的数据和表格的截取规则不同】
2.熟悉一车一档的文档
```

##### 2022年8月30日周2

```txt
1.解决现场存储过程的问题
【	path最后一位要加"\";
	config指令在存储过程中不能出现，新建查询后，执行一次config语句就可以了，不可多次
	增加自定义函数，只取字符串中的数字
】
【  - '\\181.167.10.65\ELCO_Report\' 不等于 '\\181.167.10.65\ELCO_Report' 注意最后的 \ ; 
    - exec sp_configure 'show advanced options',1
	 reconfigure;  不能多次运行在 存储过程中，会报错也不安全。不得不写的时候，运行一次后，注释掉
	- 标量函数中增加 SqlServer中获取字符串中的数字部分 的函数
		CREATE FUNCTION [dbo].[f_GetNumStr]  
        (
            @Str NVARCHAR(MAX)
        ) 
        RETURNS NVARCHAR(MAX)   
        AS   
        BEGIN   
            WHILE PATINDEX('%[^0-9]%',@Str)>0   
            BEGIN   
                --去掉非数字的字符
                SET @Str=STUFF(@Str,PATINDEX('%[^0-9]%',@Str),1,'')
            END   
            RETURN @Str 
        END
】
2.对照文档，梳理字段
```

##### 2022年8月31日周3

```txt
请假
```

##### 2022年9月1日周4

```txt
1.修改 在线测量数据 sqlserver定时任务的执行周期，改为2小时（根据实际情况一天不会超过8个文件） 
2.确认每一个文件对应的业务字段，找到表结构文档的对应关系
3.参照表结构文档，在本地 新建 一车一档对应 各个参数表
```

##### 2022年9月2日周5

```txt
1.收集一车一档业务信息，确认在线测量是否可以收集vin码，与现场确认数据展示的对应字段
2.搭建并开发一车一档目录，页面
```

##### 周报

```tx
1.解决现场存储过程的报错问题。
2.与 在线测量厂家 确认 Vin号 是否可以收集，确认 部分 在线测量数据存在问题，需对文件进行筛选删除处理
3.熟悉 柴工提供的 文档，对照文档，本地导入 工艺参数的四张表，并做模拟数据
4.由于测量数据文件量 不多，修改定时任务的执行周期，延长至2小时执行一次
5.与 现场项目经理 联络， 确认 一车一档 页面展示的相关字段
6.整理信息，在中控系统中 新增 一车一档目录，开发一车一档页面
```



### 9月

#### 第一周

##### 2022年9月5日  周1

```txt
1.与 长春红旗 现场 联络，沟通需求与相关工作的进度
2.发现存储过程中 plc_rfidsignal 信号 对应存储过程 无法 更新 Vin码数据的问题。存储过程无法解析 XML 中 <value>System.Byte[]</value>  的值。传到表里的 vin码数据 都为空
```

##### 2022年9月6日  周2

```txt
1.与 在线测量厂家 沟通 字段相关数据
2.开发 页面所需存储过程
```

##### 2022年9月7日  周3

```txt
1.解决报警内容错误的问题【错误的告警内容：光栅，激光没有被遮挡】
2.学习配置音频信号点：
	- 要在ID上 设置ip，点位(默认为0，看说明书)
	- 信号读取位置，从零开始/从1开始，禁用启用
	- 是16字节的 数据，看说明书 是 高字节开始 还是 低字节开始
	- 其他的看看说明书，配置好就有值了
```

##### 2022年9月8日  周4

```txt
截止时间:  页面查询，(导出+打包)zip功能
```

##### 2022年9月9日  周5

```txt
长春一汽项目有个紧急的工作，优先完成
1.开发长春一汽 班次定义管理+班次日历 页面
```

##### 2022年9月10日 周6

```txt
完成 长春一汽 班次定义管理+班次日历 的功能，完成测试，最后发布到svn
```



#### 第二周

##### 2022年9月13日 周2

```txt
1.修复重庆数据 更新失效的 BUG，打包交付现场
2.开发完成 班次日历复制 的 存储过程
3.开发 测试车管理页面，加在质量模块下
	【创建时间上边儿那些项是要输入的，然后底下那个项目都是自动的，你就给显示出来就行，增删改查的时候儿，你你增删改的时候儿，你不用不用管那个底下那些项。】
	
	【*号字段先不管；无特殊标识的字段都是筛选项】m_testvehiclelist表：抽取测试车身表				
    序号	字段	类型	键	说明
    1	id	int	主键	
    2	skid	nvarchar(50)		滑橇号
    3	knr	nvarchar(50)		车身码
    （*）4	modelcode	nvarchar(50)		车型代码
    （*）5	colorcode	nvarchar(50)		颜色代码
    6	testMAC	int		1：色差测试
    7	testWS	int		1：橘皮测试
    8	testPT	int		1：膜厚测试
    9	createtime	datetime		创建时间
    【不是筛选项】10	areaid	nvarchar(50)		区域，手工填入时为null
    【不是筛选项】11	isauto	int		自动创建标志，1：有效
    【不是筛选项】12	exectime	datetime		执行或取消时间
    【不是筛选项】13	iscancel	int		取消标志，1：有效

```

##### 2022年9月14日 周3

```txt
1.完成 测试车管理页面 前台 + 后台 + 存储过程的开发工作
2.完成 测试车管理页面 的功能测试工作
3.根据 实际业务 修改完善 已做完的 测试车管理页面 相关 代码及存储过程

PS： SQL中， OR之间的均为条件，可以理解为if判断
	如：a=1 OR a=3,若 a=1 成立 就截止，不再走 a=3
```

##### 2022年9月15日 周4

```txt
修改部署完成红旗大屏的功能【左侧滚动速度，中间的svg】
```

##### 2022年9月16日 周5

```txt
与红旗现场沟通需求，包括svg需要更改的部分，音频设备的连接等
```

##### 周报

```txt
1.修复 重庆工职院Mes系统 出现 websocket不更新数据 的Bug
2.完成 测试车管理页面的 前后端 + 存储过程 的 开发 和 测试
3.修改 长春红旗的 大屏的svg
4.与 长春红旗 沟通 需求，包括包括svg需要更改的部分  好 音频设备的连接
```



#### 第三周

##### 预期工作

```txt
1.开发 文件 导入导出功能。完成前后端交互【需要将文件目录存到表里】
2.查找 音频设备 说明书， 根据 说明书 配置kepserver，再确定之后的开发方法
3.修改svg【按照 需求 文件中需要修改的条件 进行修改】
```

##### 2022年9月19日周1

```txt
1.完成svg的第六次修改
2.远程使用kepserver建立音频连接 ADAM-6052 
	通道类型：Modbus TCP/IP Ethemet
	IP：10.0.0.10
	端口：502
3.
	
```

p216

![image-20220919151521322](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20220919151521322.png)

##### 2022年9月20日周2

```txt
居家隔离，远程办公
远程支持 红旗现场的开发工作与维护工作
```

##### 2022年9月21日周3

```txt
1.与 红旗 现场 远程联调 联华控制器和大普音频设备
2.现场 Plcdataset 与 Plcdatatag 表 中 新增 研华数据点ADAM6052
3.完成研华数据点的调试
```

##### 2022年9月22日周4

```txt
1.修改大屏SVG。完成数据测试，远程部署
2.在 报警-实时信号查询 新增 区域筛选项，包括前后台+存储过程
3.报警查询 部分 做了前端展示优化，将所有 英文区域 改为 对应的中文
```

##### 2022年9月23日周5

```txt
1.与 红旗现场 沟通Vin码的数据来源问题，在焊蒙只能提供重复Vin码的情况下，通过中控项目生成唯一的Vin码
2.修改vin码的存入规则，更新数据表中的vin码数据
3.开发以 Vin码 + 外键ID 为 关联的数据查找过程。
```

##### 周报

```txt
主要负责项目：红旗AndonL平台、重庆Mes工职院。偶尔协助 长春一汽大众涂装车间项目
1.远程联调 大普音频设备 + 联华控制器6052。用研华测试软件 完成 软硬件 联调测试。
2.现场 Plcdataset 与 Plcdatatag 表 中 新增 研华数据点ADAM6052。并完成 研华数据点 的调试工作
3.修改大屏SVG。完成数据测试，远程部署
4.在 报警-实时信号查询 新增 区域筛选项，包括前后台+存储过程
5.报警查询 部分 做了前端展示优化，将所有 英文区域 改为 对应的中文
6.与 红旗现场 沟通Vin码的数据来源问题，在焊蒙只能提供重复Vin码的情况下，通过中控项目生成唯一的,与车辆对应的Vin码
7.修改vin码的存入规则，更新数据表中的vin码数据
8.开发以 Vin码 + 外键ID 为 关联的数据查找过程。
```



#### 第四周

##### 2022年9月26日周1

```txt
解决重庆现场订单页面 的前端样式问题【长订单号展示，多订单展示】
```

##### 2022年9月27日周2

```txt
1.开发 在线测量数据 联查存储过程
2.调整 长春一汽二涂项目 的 日历部分样式
```

##### 2022年9月28日周3

```txt
开发 一车一档 数据页面【前端，后端，存储过程】
```

##### 2022年9月29日周4

```txt
1.开发完成在线测量数据 的 查询功能
2.整理GRJ2025_HongQiN117Andon 项目 的相关代码，需求文档，数据文档等资料，以云盘的形式发送给商金峰
```

###### 2022年9月30日周5

```txt
空
```

##### 周报

```txt
1.完成 红旗Andon平台 的 在线测量数据 查询功能
2.调整 长春一汽二涂项目 的 日历部分样式
3.整理GRJ2025_HongQiN117Andon 项目 的相关代码，需求文档，数据文档等资料，以云盘的形式发送给商金峰
4.解决重庆现场订单页面 的前端样式问题，并打包发送给重庆工职院现场
```



### 10月

#### 第一周

##### 2022年10月5日周3

```txt
工作内容：
1.给测试车管理加自动更新，存储过程web_testvehiclelist_check已加好，websocket写法参见小魏写的FastOut287_387。
2.给班次的起始时间、结束时间、休息开始时间和休息结束时间都加一个“转天”的checkbox选项，这个客户的班次时间弹性太大
3.测试车界面你加一个多选checkbox列，可以选定多个记录进行删除。参考fastout287_387页面

4.加一个界面：色差测试优先管理
车型短名称从basemodel表的shortname字段选取，
颜色从basecolor表colorcode自动取前2位

查询字段：
界面显示：model表的 shortname+ color表的 colorcode【截取前两位】
按照基础表的车型、颜色顺序进行排序

【上面这个表和两个basecolor和basemodel存储过程我已经更新了】
【web_basemodel_list_sel和web_basecolor_list_sel我已加了第三个select查询】

(按测试车管理 页面 做，增删改查页面)


已完成：
1.给测试车管理增加自动更新功能，包括前台建立websocket连接，后台更新websocket数据
2.为 班次 部分 中增加 转天 选择框，只修改了前端的 时间校验，使客户可以自由选择 班次时间是否转天
3.为 测试车管理页面 新增批量删除功能
```

![image-20221005150847480](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221005150847480.png)

##### 2022年10月6日周4

```txt
4.加一个界面：色差测试优先管理
车型短名称从basemodel表的shortname字段选取，
颜色从basecolor表colorcode自动取前2位
```

##### 2022年10月8日周6

```txt
1.色差测试优化管理：修改 查询功能，批量删除改为单一删除，删除筛选项
2.测试车管理页面：新增 初始查询时间 判定，小于8:00 大于0:00 则为前一天
3.跟进 长春一汽二涂 部署工作
```

##### 2022年10月9日周7

```txt
1.开发 线间橇号调车管理 的 增删改查功能
2.测试车 和 线间撬号调车管理 的 批量删除 修改为 xml传参

ps：一页多数据时，批量删除，需前台 传 xml 给后台，js前端escape编码，C#后端unescape解码，在数据库，使用临时表 存 xml，进行批量删除

下面为sql：
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:  朱泓锦
-- Create date: 2022-10-9 11:34:37
-- Description: 287_387_L1F05控制--线间撬号调车管理 批量删除
-- =============================================
ALTER PROCEDURE [dbo].[web_moveskid287_387_del] @xml XML
   WITH
   EXEC AS CALLER
AS
BEGIN
   IF OBJECT_ID ('tempdb..#temp') IS NOT NULL
      DROP TABLE #temp

   SELECT T.C.value ('id[1]', 'int') AS 'id'
   INTO #temp
   FROM @xml.nodes ('/Root/Row') AS T (C)

   BEGIN TRY
      BEGIN TRANSACTION
      DECLARE @n   INT
      --锁定信号量防止与调度规则冲突
      SET @n =
             (SELECT count (*)
              FROM Sem WITH (TABLOCKX)
              WHERE 1 = 0)

      DELETE FROM[dbo].[m_287387moveskid]
      WHERE [id] IN (SELECT [id] FROM #temp)

      --更新通知时间戳
      UPDATE[dbo].[lasttime]
      SET [timestamp] = getdate ()
      WHERE [id] = 8

      COMMIT;
   END TRY
   BEGIN CATCH
      ROLLBACK
      DECLARE @MESSAGE   NVARCHAR (4000)
      DECLARE @SEVERITY   INT
      DECLARE @STATE   INT
      SET @MESSAGE = ERROR_MESSAGE ()
      SET @SEVERITY = ERROR_SEVERITY ()
      RAISERROR (@MESSAGE, @SEVERITY, 1)
   END CATCH
END
```

#### 第二周

##### 2022年10月10日周1

```txt
统一287、387线间撬号调车管理 页面的 菜单项，样式 与 同类页面样式一致

修改工作记录：
1.清空结束日期 时间框
2.目的区域 为空 不能插入或修改
3.layout布局修改，区域分为 north 与 center 【center中再划分为 north + center】
```

##### 2022年10月11日周2

```txt
需做工作：
1. 搜索起始时间的校验，要修改，比如当日为1号的时候，就要特殊处理【已解决-筛选项已删除】
2. 班次日历的字体大小改一下，老章说字体大了
3. 调整select格式，改下写法，调整格式
```

##### 2022年10月12日周3

```txt
1.确认 质量信息下 膜厚标准,点位配置,桔皮标准,色差标准,比例因子 5个页面的 筛选项，按钮，列表展示 等需求
2.创建 质量报告所需 的5个 配置页面 ，处理程序
3.开发完成 膜厚标准 页面 的 业务功能，完成了 功能测试

日志：
    等下 对照示例页 把页面，处理程序 建好
    膜厚标准 PTStandardValue
    点位配置 PointsOption
    桔皮标准 WsstandardValue
    色差标准 MacStandardValue
    比例因子 ScalingFactor
```

##### 2022年10月13日周4

```txt
开发 点位配置 页面 中 膜厚配置+点位配置 的 增改查存储过程
```

##### 2022年10月14日周5

```txt
开发 色差标准值/色差标准图 的 存储过程
开发 比例因子 的存储过程
```

##### 周报

```txt
1. 测试车管理 页面 新增websocket 实时更新数据
2. 修改 班次日历 的 js + 存储过程【日期校验；查询添加 typeid】
3. 完成 色差测试优先管理页面。完成 功能测试，数据测试。 后续 修改样式，修改查询与删除 功能
4. 完成 线间撬号调车管理 页面。 修改删除为 xml传参。后续 修改样式【时间框 初始化；目的区域校验；添加layout布局】
5. 与吴工 开会确认 膜厚配置等5个页面 的 筛选项、按钮、列表项 和 增改查时的校验
6. 开发 膜厚配置 部分 的全部存储过程【膜厚标准值表、(膜厚配置+点位配置)、桔皮标准值表、(色差标准值表+色差标准图表)、比例因子表】
7. 开发完成 膜厚标准值 表 的 页面+处理程序
```



#### 第三周

##### 2022年10月17日周1

```txt
1. 在 点位配置处理程序 新增 partcode查询接口
2. 开发 各膜厚配置处理程序 的增改查 接口
```

##### 2022年10月18日周2

```txt
1.开发 膜厚配置+色差标准图 Excel导入导出 后端API
2.修改 膜厚配置 增改 存储过程
3.把文件导入 和 其他字段 作了区分

开发完成： Excel文件导入 + Excel文件导出
```

##### 2022年10月19日周3

```txt
1.开发 色差标准图 的导入预览
2.开发 桔皮配置 页面，完成前后端的联调，功能测试
3.开发 比例因子 页面，完成前后端的联调，功能测试

开发完成：图片导入+预览 接口；桔皮配置页面；比例因子页面
```

##### 2022年10月20日周4

```txt
开发 点位配置页面
```

##### 2022年10月21日周5

```txt
开发 点位配置页面 。完成前后端联调。修改编辑新增的存储过程。完成功能测试
```

##### 周报

```txt
1.完成 膜厚配置 等 5个页面 的所有增删改查存储过程，并使用假数据验证
2.完成 5个页面 的 Handler 接口。并使用Postman验证
3.完成 膜厚配置，桔皮配置，比例因子 3个页面 。并完成这三个页面的功能测试【增改查，无导入导出】
4.完成 点位点位配置 页面。调试 导入导出功能和编辑新增功能。完成 导入导出，编辑新增等功能测试
```



#### 第四周

##### 2022年10月24日周1

```txt
1.完成 色差值 与 色差图 的 页面功能 与 前后端联调。
2.修改 色差图 的部分存储过程
3.测试色差图的导入导出功能
```

##### 2022年10月25日周2

```txt
待完成：
	1. 把sql培训手册 转为md格式，存入work_log文件夹
	2. 测试 膜厚标准这 5个页面 功能

已完成：
	1.测试 膜厚配置的5个页面
	2.提交 前后端代码到 SVN	
```

##### 2022年10月26日周3

```txt
待完成：
	1.修改配置页面的功能	
	2.为点位配置表 增加 “删除功能”
已完成：
	1.开会审查 配置页面 的功能页面，及 需要修改的内容
	2.完成 点位配置表 "删除功能"。完成功能测试
	2.修改 配置页面 的功能页面，后端，存储过程
```

###### ps : 

​	上午开会确认后的 5个配置表 的 表结构

​	t_ptstandardvalue表：膜厚标准值表

 【注: colorcode 不可为空】

![image-20221026133755324](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026133755324.png)

​	

​	t_ptoption表：膜厚配置

![image-20221026133847097](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026133847097.png)

t_pointsoption表：点位配置

![image-20221026133923337](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026133923337.png)

t_wsstandardvalue表：表 桔皮配置

【注意：pattable有一个专门的list 存储过程】

![image-20221026134002966](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026134002966.png)





t_macstandardvalue表：色差标准值表

![image-20221026134033081](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026134033081.png)

t_macstandardpicture表：色差标准图表

![image-20221026134103309](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026134103309.png)



t_scalingfactor表：比例因子表

![image-20221026134132016](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221026134132016.png)



##### 2022年10月27日周4

待完成：
1.~~页面添加必填项提示~~ 
2.~~修改colorcode为手动输入，查询的时候要有名字【膜厚标准】~~
3.~~增加最大最小值的校验【所有配置页面】~~
4.~~修改 ptOption搜索车型为 LIKE搜索~~
5.~~修改 在 数据 编辑时，不再更新时戳【所有配置页面】~~
6.~~初始化datagrid表格数据~~
7.~~这个图片名字应该是我们定义的。【图片名： 时间戳+id】【色差标准】~~
8.~~角度排个序15 25 45 75 110~~。【色差标准】
9.~~表格里车型缩写改为车型。车型缩写是我们自个定义的，客户那边没有这个说法。【色差标准】~~
10.~~图片名那列放宽点~~ 。【色差标准】
11~~.初始化 点位配置+色差标准 这两个页面 的datagrid~~
12.~~加列 部位名称【桔皮标准】~~
13.~~左边两列宽一点，右边表格可以窄一点。【点位配置】~~
14.~~新增，编辑，对车型代码加个校验，车型不能重复【点位配置】~~
15.~~表格“创建时间” 名字改成 “时间”。【点位配置】~~
16.~~这边的时间查询条件可以去掉。【点位配置】~~

```txt
已完成：
	1.页面添加必填项提示 
2.修改colorcode为手动输入，查询的时候要有名字【膜厚标准】
3.增加最大最小值的校验【所有配置页面】
4.修改 ptOption搜索车型为 LIKE搜索
5.修改 在 数据 编辑时，不再更新时戳【所有配置页面】
6.初始化datagrid表格数据
7.这个图片名字应该是我们定义的。【图片名： 时间戳+id】【色差标准】
8.角度排个序15 25 45 75 110。【色差标准】
9.表格里车型缩写改为车型。车型缩写是我们自个定义的，客户那边没有这个说法。【色差标准】
10.图片名那列放宽点 。【色差标准】
11.初始化 点位配置+色差标准 这两个页面 的datagrid
12.加列 部位名称【桔皮标准】
13.左边两列宽一点，右边表格可以窄一点。【点位配置】
14.新增，编辑，对车型代码加个校验，车型不能重复【点位配置】
15.表格“创建时间” 名字改成 “时间”。【点位配置】
16.这边的时间查询条件可以去掉。【点位配置】
```

PS: 

```txt
膜厚配置 编辑/新增：参数为数组，需要查询每个元素 在表中是否出现。
	解决方案：先使用 string_split(参数)转为 数据表。再使用主表 leftjoin 这个数据表，做数据处理就可以了
	代码：
	left join (select value 'paramModel' from string_split('C4G.,V4P.',',')) cc on tpo.modelcode LIKE ('%' + cc.paramModel + '%')
```

##### 2022年10月28日周5

```txt
1.开发色差图页面的预览图片弹窗，定制样式
2.按红旗客户的需求修改红旗Andon大屏的svg。完成测试，部署
```

##### 周报

```txt
1.开发完成 质量信息部分的5个配置页面。并完成功能测试。更新提交svn
2.团队内部开会确认 配置页面需要更改的功能，数据表设计等
3.测试配置页面。根据问题word文件，逐项修改功能，并完成测试，确认已修复。
4.与吴工沟通，完成 配置页面的部署工作
5.按红旗客户的需求修改红旗Andon大屏的svg。完成测试，部署
```



### 11月

#### 第一周

##### 2022年10月31日周1

```txt
回顾 长春二次涂装项目“质量信息，系统控制”部分中负责页面出现的错误
```

##### 2022年11月1日周2

```txt
1.记录长春二涂项目 中 负责部分出现的程序错误，样式问题，测试问题
```

###### 记录

```txt
1.js实现时间提前一天
    function GetDateStr(AddDayCount) {
        var dd = new Date();
        dd.setDate(dd.getDate()+AddDayCount);//获取AddDayCount天后的日期
        var y = dd.getFullYear();
        var m = dd.getMonth()+1;//获取当前月份的日期
        var d = dd.getDate();
        return y+"-"+m+"-"+d;
    }
    document.write("前天："+GetDateStr(-2));
    document.write("
    昨天："+GetDateStr(-1));
    document.write("
    今天："+GetDateStr(0));
    document.write("
    明天："+GetDateStr(1));
    document.write("
    后天："+GetDateStr(2));
    document.write("
    大后天："+GetDateStr(3));
2.css背景图自适应居中
  <div id="e_img" style="width: 100px; height: 300px; margin: 0 auto;"/>
  #e_img{
  	background-size:contain;
  	background-position:center;
  	background-repeat: no-repeat
  }
  
   $("#e_img").css("background-image", "url(" + data + ")"); //数据来源：ajax成功回调
3.图片预览后台：
    //获取文件地址
    string fileName = dt.Rows[0]["filename"].ToString(); ;
    string pubFilePath = ConfigurationManager.AppSettings["imgFilePath"].ToString();
    string imgfilePath = pubFilePath + fileName;

    //判断是否存在
    string imgPath = "";
    if (File.Exists(imgfilePath)) {
    //导出文件
    byte[] data = File.ReadAllBytes(imgfilePath);
    imgPath = "data:image/png;base64," + Convert.ToBase64String(data);
    }
    else
    {
    imgPath = "false";
    }

    Response.Write(imgPath);
    Response.End();
   
  数据流 => 转码为base64数据串，传给前端
  前端：将src属性修改成对应的base64数据串，即可查看图片
```

##### 2022年11月2日周3

```txt
1.回顾 长春二次涂装项目“质量信息，系统控制”部分中负责页面出现的错误
2.确认 284_384颜色车型白名单 的页面与功能需求
```

##### 2022年11月3日周4

```txt
1.修改 284_384颜色车型白名单 页面业务功能  
2.开发 284_384颜色车型黑名单
【要求：车型，颜色 不能同时为空；车型 颜色 不能成对重复】
```

##### 2022年11月4日周5

```txt
1.完成 黑名单页面 的前后端联调，功能测试
```

##### 周报

```txt
1.回顾 长春二次涂装项目“质量信息，系统控制”部分中负责页面出现的功能问题，并记录到日志文件里
2.确认 284_384颜色车型白名单 的页面与功能需求，开发白名单页面。完成前后端联调，功能测试
3.调整 白名单页面 的功能逻辑
4.开发 284_384颜色车型黑名单，完成 黑名单页面 的前后端联调，功能测试
```



#### 第二周

##### 2022年11月7日周1

```txt
休假
```

##### 2022年11月8日周2

```txt
出车换色限制: (当前颜色+新换颜色)不能重复；当前颜色 与 新换颜色不能重复
出车颜色数量限制：(区域+颜色代码)不能重复

IF EXISTS
		(SELECT *
			FROM m_284384outcolorgaplimit 
			WHERE [colorcode] = @colorcode  AND
				  [modelcode] = @modelcode	AND
				  [areaid]    = @areaid	)
		RAISERROR ('颜色与角度 不可重复！', 16, 1);

1.开发 284_384出车换色限制 与 284_384出车颜色数量限制 页面
2.确认 数据的筛选条件。完成页面测试
```

##### 2022年11月9日周3

```txt
1.修改 黑名单，出车页面： 按钮样式；批量删除改为单行删除；修改弹窗文本
```

##### 2022年11月10日周4

```txt
完成 佛山中控项目的 AS报文配置页面 的开发工作，功能测试。样式与WE报文配置相同
```

##### 2022年11月11日周5

```txt
1.沟通佛山中控项目-告警查询部分业务需求
2.开发告警排名页面
```

##### 周报

```txt
1.开发 284_384出车换色限制 与 284_384出车颜色数量限制 页面；确认 数据的筛选条件；完成页面测试；
2.修改 黑名单，出车页面： 按钮样式；批量删除改为单行删除；修改弹窗文本
3.完成 佛山中控项目的 AS报文配置页面 的开发工作，功能测试。样式与WE报文配置相同
4.沟通佛山中控项目-告警查询部分业务需求；开发告警排名页面
```



#### 第三周

##### 2022年11月14日周1

```txt
1.完成告警排名页面的开发，假数据测试
2.按新需求开发开动率查询的存储过程
```
##### 2022年11月15日周2

```txt
1.根据客户的需求，修改告警排名的页面排序，告警时长的展示。
2.为佛山中控的页面增加初始化加载功能
3.修改当前告警页面和告警记录页面的告警时长展示
```
###### 今日收获

```txt
SQL秒转 小时 分 秒 
SELECT CONVERT(VARCHAR(8),CONVERT(TIME,DATEADD(ss,20000,'1900-01-01 00:00:00'))) 

‘1900-01-01 00:00:00’ 为起点时间，DATEADD用于计算 20000 与 00:00:00之间的差值，第一个参数 ss代表转换单位为秒【其他的单位诸如：
				year, yyyy, yy = Year
                quarter, qq, q = Quarter  季度
                month, mm, m = month
                dayofyear, dy, y = Day of the year
                day, dd, d = Day
                week, ww, wk = Week
                weekday, dw, w = Weekday
                hour, hh = hour
                minute, mi, n = Minute
                second, ss, s = Second
                millisecond, ms = Millisecond
		 】
DateAdd方法具体查询路径：https://www.w3school.com.cn/sql/func_dateadd.asp【中文】
					  https://www.w3schools.com/sql/func_sqlserver_dateadd.asp【EN】
```



##### 2022年11月16日周3

```txt
1.解决告警排名页面中，查询遮罩层闪屏的问题
```
###### PS：

###### 如何关闭easyui中datagrid的默认查询加载时 的 遮罩层

![image-20221116101322342](C:\Users\zhj\AppData\Roaming\Typora\typora-user-images\image-20221116101322342.png)

```txt
/*datagrid刷新屏闪:关*/
.datagrid-mask {
opacity: 0;
filter: alpha(opacity&=0);
}

.datagrid-mask-msg {
opacity: 0;
filter: alpha(opacity=0);
}
```



##### 2022年11月17日周4

```txt
为佛山中控的页面增加初始化加载功能
```
##### 2022年11月18日周5

```txt
为佛山中控的页面增加初始化加载功能
```
##### 周报
```txt
1.完成告警排名页面的开发，假数据测试
2.按新需求开发开动率查询的存储过程
3.根据客户的需求，修改告警排名的页面排序，告警时长的展示。
4.修改当前告警页面和告警记录页面的告警时长展示
5.解决告警排名页面中，查询遮罩层闪屏的问题
6.为佛山中控的页面增加初始化加载功能
```



#### 第四周

##### 2022年11月21日周1

```txt
修改 长春一汽二次涂装项目 的easyUI代码。
【单表页面：region属性为north+center；多表页面：region属性为north+center+east/west+south+嵌套】
```

##### 2022年11月22日周2

```txt

```

##### 2022年11月23日周3

```txt

```

##### 2022年11月24日周4

```txt

```

##### 2022年11月25日周5

```txt

```

##### 周报

```txt
1.修改长春二涂项目的前端代码，区别单表页面与多表页面
```

